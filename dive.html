<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Locomotive Scroll Responsive Example</title>

    <!-- Locomotive Scroll CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.css" />

    <!-- link style.css -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <!-- A fixed background video -->
    <div class="fixedVideo">
        <video src="videos/dive.mp4" autoplay loop muted></video>
    </div>

    <!-- Locomotive Scroll container -->
    <div data-scroll-container>

        <!-- Section 1 -->
        <section data-scroll-section>
            <h1 data-scroll>Section 1</h1>
            <p data-scroll data-scroll-speed="3" style="color:grey">
                This text moves faster (vertical parallax).
            </p>
        </section>

        <!-- A section with text AND a GIF going right-to-left -->
        <section data-scroll-section>
            <div class="scroll-gif-container" id="gif-scroll-target">
                <!-- A paragraph that might move slightly or stay still -->
                <p data-scroll data-scroll-speed="1" data-scroll-target="#gif-scroll-target">
                    Some text that goes here. There will also be an image moving with it.
                </p>

                <!-- The GIF going from right to left -->
                <img src="images/illustrations/1847_butuan.gif" alt="Butuan Expedition GIF" data-scroll
                    data-scroll-direction="horizontal" data-scroll-speed="-5" data-scroll-target="#gif-scroll-target"
                    class="butuan-gif" />
            </div>
        </section>

        <!-- each letter has its own vertical scrolling -->
        <section data-scroll-section class="">
            <span class="c-lerp-block_title" data-scroll>
                <!-- Each letter has its own speed or delay -->
                <span data-scroll data-scroll-delay="0.13" data-scroll-speed="1">B</span>
                <span data-scroll data-scroll-delay="0.12" data-scroll-speed="2">y</span>
                <span data-scroll data-scroll-delay="0.11" data-scroll-speed="3"> </span>
                <span data-scroll data-scroll-delay="0.10" data-scroll-speed="4">L</span>
                <span data-scroll data-scroll-delay="0.09" data-scroll-speed="5">e</span>
                <span data-scroll data-scroll-delay="0.08" data-scroll-speed="6">t</span>
                <span data-scroll data-scroll-delay="0.07" data-scroll-speed="7">t</span>
                <span data-scroll data-scroll-delay="0.06" data-scroll-speed="8">e</span>
                <span data-scroll data-scroll-delay="0.05" data-scroll-speed="9">r</span>
            </span>
        </section>

        <!-- now moving left to right -->
        <section data-scroll-section>
            <div class="scroll-gif-container" id="gif-scroll-target2">
                <!-- A paragraph that might move slightly or stay still -->
                <p data-scroll data-scroll-speed="1" data-scroll-target="#gif-scroll-target2">
                    Some text that goes here. There will also be an image moving with it.
                </p>

                <!-- The GIF going from right to left -->
                <img src="images/mpc/MPC_Gold.gif" alt="Butuan Expedition GIF" data-scroll
                    data-scroll-direction="horizontal" data-scroll-speed="5" data-scroll-target="#gif-scroll-target2"
                    class="butuan-gif" />
            </div>
        </section>




        <!-- horizontal scrolling -->
        <section data-scroll-section class="dark">
            <div data-scroll data-scroll-direction="horizontal" data-scroll-speed="5"
                style="color: white; padding: 1rem;">
                <img src="images/sea/fish1.png">
            </div>
        </section>

        <section data-scroll-section class="dark">
            <div data-scroll data-scroll-direction="horizontal" data-scroll-speed="-15"
                style="color: white; padding: 1rem;">
                <img src="images/sea/fish2.png">
            </div>
        </section>

        <!-- fade in -->
        <!-- Section 2: Show fade-in with no parallax movement -->
        <section data-scroll-section class="dark">
            <p data-scroll data-scroll-class="fade-in" data-scroll-speed="0" style="font-size: 2rem;padding: 1rem;">
                I will fade away forever.
            </p>

        </section>

        <!-- Paragraph with each letter having its own vertical scrolling (speeds & delays) -->
        <section data-scroll-section class="dark">
            <span class="c-lerp-block_title" data-scroll>

                <!-- "This is a longer test in which each character has its own buoyancy" -->

                <!-- T -->
                <span data-scroll data-scroll-delay="0.30" data-scroll-speed="1">T</span>
                <!-- h -->
                <span data-scroll data-scroll-delay="0.29" data-scroll-speed="2">h</span>
                <!-- i -->
                <span data-scroll data-scroll-delay="0.28" data-scroll-speed="3">i</span>
                <!-- s -->
                <span data-scroll data-scroll-delay="0.27" data-scroll-speed="4">s</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.26" data-scroll-speed="5"> </span>
                <!-- i -->
                <span data-scroll data-scroll-delay="0.25" data-scroll-speed="6">i</span>
                <!-- s -->
                <span data-scroll data-scroll-delay="0.24" data-scroll-speed="7">s</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.23" data-scroll-speed="8"> </span>
                <!-- a -->
                <span data-scroll data-scroll-delay="0.22" data-scroll-speed="9">a</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.21" data-scroll-speed="10"> </span>
                <!-- l -->
                <span data-scroll data-scroll-delay="0.20" data-scroll-speed="1">l</span>
                <!-- o -->
                <span data-scroll data-scroll-delay="0.19" data-scroll-speed="2">o</span>
                <!-- n -->
                <span data-scroll data-scroll-delay="0.18" data-scroll-speed="3">n</span>
                <!-- g -->
                <span data-scroll data-scroll-delay="0.17" data-scroll-speed="4">g</span>
                <!-- e -->
                <span data-scroll data-scroll-delay="0.16" data-scroll-speed="5">e</span>
                <!-- r -->
                <span data-scroll data-scroll-delay="0.15" data-scroll-speed="6">r</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.14" data-scroll-speed="7"> </span>
                <!-- t -->
                <span data-scroll data-scroll-delay="0.13" data-scroll-speed="8">t</span>
                <!-- e -->
                <span data-scroll data-scroll-delay="0.12" data-scroll-speed="9">e</span>
                <!-- s -->
                <span data-scroll data-scroll-delay="0.11" data-scroll-speed="10">s</span>
                <!-- t -->
                <span data-scroll data-scroll-delay="0.10" data-scroll-speed="1">t</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.09" data-scroll-speed="2"> </span>
                <!-- i -->
                <span data-scroll data-scroll-delay="0.08" data-scroll-speed="3">i</span>
                <!-- n -->
                <span data-scroll data-scroll-delay="0.07" data-scroll-speed="4">n</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.06" data-scroll-speed="5"> </span>
                <!-- w -->
                <span data-scroll data-scroll-delay="0.05" data-scroll-speed="6">w</span>
                <!-- h -->
                <span data-scroll data-scroll-delay="0.04" data-scroll-speed="7">h</span>
                <!-- i -->
                <span data-scroll data-scroll-delay="0.03" data-scroll-speed="8">i</span>
                <!-- c -->
                <span data-scroll data-scroll-delay="0.02" data-scroll-speed="9">c</span>
                <!-- h -->
                <span data-scroll data-scroll-delay="0.01" data-scroll-speed="10">h</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.13" data-scroll-speed="1"> </span>
                <!-- e -->
                <span data-scroll data-scroll-delay="0.12" data-scroll-speed="2">e</span>
                <!-- a -->
                <span data-scroll data-scroll-delay="0.11" data-scroll-speed="3">a</span>
                <!-- c -->
                <span data-scroll data-scroll-delay="0.10" data-scroll-speed="4">c</span>
                <!-- h -->
                <span data-scroll data-scroll-delay="0.09" data-scroll-speed="5">h</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.08" data-scroll-speed="6"> </span>
                <!-- c -->
                <span data-scroll data-scroll-delay="0.07" data-scroll-speed="7">c</span>
                <!-- h -->
                <span data-scroll data-scroll-delay="0.06" data-scroll-speed="8">h</span>
                <!-- a -->
                <span data-scroll data-scroll-delay="0.05" data-scroll-speed="9">a</span>
                <!-- r -->
                <span data-scroll data-scroll-delay="0.04" data-scroll-speed="10">r</span>
                <!-- a -->
                <span data-scroll data-scroll-delay="0.03" data-scroll-speed="1">a</span>
                <!-- c -->
                <span data-scroll data-scroll-delay="0.02" data-scroll-speed="2">c</span>
                <!-- t -->
                <span data-scroll data-scroll-delay="0.01" data-scroll-speed="3">t</span>
                <!-- e -->
                <span data-scroll data-scroll-delay="0.13" data-scroll-speed="4">e</span>
                <!-- r -->
                <span data-scroll data-scroll-delay="0.12" data-scroll-speed="5">r</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.11" data-scroll-speed="6"> </span>
                <!-- h -->
                <span data-scroll data-scroll-delay="0.10" data-scroll-speed="7">h</span>
                <!-- a -->
                <span data-scroll data-scroll-delay="0.09" data-scroll-speed="8">a</span>
                <!-- s -->
                <span data-scroll data-scroll-delay="0.08" data-scroll-speed="9">s</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.07" data-scroll-speed="10"> </span>
                <!-- i -->
                <span data-scroll data-scroll-delay="0.06" data-scroll-speed="1">i</span>
                <!-- t -->
                <span data-scroll data-scroll-delay="0.05" data-scroll-speed="2">t</span>
                <!-- s -->
                <span data-scroll data-scroll-delay="0.04" data-scroll-speed="3">s</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.03" data-scroll-speed="4"> </span>
                <!-- o -->
                <span data-scroll data-scroll-delay="0.02" data-scroll-speed="5">o</span>
                <!-- w -->
                <span data-scroll data-scroll-delay="0.01" data-scroll-speed="6">w</span>
                <!-- n -->
                <span data-scroll data-scroll-delay="0.10" data-scroll-speed="7">n</span>
                <!-- space -->
                <span data-scroll data-scroll-delay="0.09" data-scroll-speed="8"> </span>
                <!-- b -->
                <span data-scroll data-scroll-delay="0.08" data-scroll-speed="9">b</span>
                <!-- u -->
                <span data-scroll data-scroll-delay="0.07" data-scroll-speed="10">u</span>
                <!-- o -->
                <span data-scroll data-scroll-delay="0.06" data-scroll-speed="1">o</span>
                <!-- y -->
                <span data-scroll data-scroll-delay="0.05" data-scroll-speed="2">y</span>
                <!-- a -->
                <span data-scroll data-scroll-delay="0.04" data-scroll-speed="3">a</span>
                <!-- n -->
                <span data-scroll data-scroll-delay="0.03" data-scroll-speed="4">n</span>
                <!-- c -->
                <span data-scroll data-scroll-delay="0.02" data-scroll-speed="5">c</span>
                <!-- y -->
                <span data-scroll data-scroll-delay="0.01" data-scroll-speed="6">y</span>

            </span>
        </section>



        <section data-scroll-section class="dark">
            <p data-scroll data-scroll-speed="2"><a href="">recover your breath</a></p>
        </section>

    </div>

    <!-- Locomotive Scroll JS -->
    <script src="https://cdn.jsdelivr.net/npm/locomotive-scroll@4.1.4/dist/locomotive-scroll.min.js"></script>

    <!-- include main.js -->
    <!-- <script src="main.js"></script> -->

    <script>
        // Initialize Locomotive Scroll
        const scroll = new LocomotiveScroll({
            el: document.querySelector('[data-scroll-container]'),
            smooth: true
        });

        // On resize, update the locomotive instance to recalc positions
        window.addEventListener('resize', () => {
            if (scroll) scroll.update();
        });

        // 1) Create the audio object
        const audio = new Audio('sounds/Underwater-sounds-loopable.wav');
        audio.loop = true;          // Make it loop
        audio.volume = 0;           // Start at volume 0
        let isPlaying = false;      // Track if we’re currently playing audio
        let fadeInterval = null;    // For fade in / fade out intervals
        let lastScrollTime = 0;     // When user last scrolled

        // Fade in over ~1 second
        function fadeInAudio() {
            // If we’re already in a fadeInterval, clear it
            if (fadeInterval) clearInterval(fadeInterval);

            // If audio is paused, start playback
            if (audio.paused) {
                audio.play().catch(err => {
                    console.warn('Audio playback failed:', err);
                });
            }
            isPlaying = true;

            const targetVolume = 1.0;  // Full volume
            const fadeSteps = 10;      // We'll do 10 steps
            const stepDuration = 100;  // 100ms per step => total ~1s
            let currentStep = 0;

            fadeInterval = setInterval(() => {
                currentStep++;
                // Calculate new volume
                const newVolume = (currentStep / fadeSteps) * targetVolume;
                audio.volume = Math.min(newVolume, targetVolume);

                if (currentStep >= fadeSteps) {
                    clearInterval(fadeInterval);
                    fadeInterval = null;
                }
            }, stepDuration);
        }

        // Fade out over ~1 second, then pause
        function fadeOutAudio() {
            if (fadeInterval) clearInterval(fadeInterval);
            isPlaying = false;

            const initialVolume = audio.volume;
            const fadeSteps = 10;
            const stepDuration = 100;
            let currentStep = 0;

            fadeInterval = setInterval(() => {
                currentStep++;
                // Decrease volume from initialVolume down to 0
                const newVolume = initialVolume * (1 - (currentStep / fadeSteps));
                audio.volume = Math.max(newVolume, 0);

                if (currentStep >= fadeSteps) {
                    clearInterval(fadeInterval);
                    fadeInterval = null;
                    audio.pause();
                }
            }, stepDuration);
        }

        // when user scrolls...
        scroll.on('scroll', () => {
            // Track the time user last scrolled
            lastScrollTime = Date.now();

            console.log("scrolling");

            // If not currently playing, fade in
            if (!isPlaying) {
                fadeInAudio();
            }
        });

        document.body.addEventListener('click', () => {
            // Track the time user last scrolled
            lastScrollTime = Date.now();

            // If not currently playing, fade in
            if (!isPlaying) {
                fadeInAudio();
            }
        });

        // Check every 250ms if the user has been idle for 3 seconds
        setInterval(() => {
            if (isPlaying) {
                const now = Date.now();
                const elapsed = now - lastScrollTime;
                // If 3s passed without scrolling, fade out
                if (elapsed >= 3000) {
                    fadeOutAudio();
                }
            }
        }, 250);
    </script>

</body>

</html>